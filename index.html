<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Game + Giga Ads</title>
<style>
    body {
        margin: 0;
        background: #111;
        overflow: hidden;
        font-family: Arial, sans-serif;
    }
    #gameCanvas {
        display: block;
        margin: auto;
        background: #222;
    }
    #timerContainer {
        position: absolute;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        width: 100px;
        height: 100px;
    }
    #timerCircle {
        transform: rotate(-90deg);
    }
    #timerText {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 24px;
        color: white;
        font-weight: bold;
    }
    .pulse {
        animation: pulse 0.5s infinite;
    }
    @keyframes pulse {
        0% { transform: translate(-50%, -50%) scale(1); }
        50% { transform: translate(-50%, -50%) scale(1.1); }
        100% { transform: translate(-50%, -50%) scale(1); }
    }
</style>
</head>
<body>

<svg id="timerContainer">
    <circle cx="50" cy="50" r="45" stroke="#444" stroke-width="8" fill="none"/>
    <circle id="timerCircle" cx="50" cy="50" r="45" stroke="green" stroke-width="8" fill="none" stroke-linecap="round" stroke-dasharray="283" stroke-dashoffset="0"/>
    <text id="timerText">10</text>
</svg>

<canvas id="gameCanvas" width="800" height="500"></canvas>

<audio id="beepSound" src="https://www.soundjay.com/button/beep-07.wav"></audio>
<audio id="gameOverSound" src="https://www.soundjay.com/button/beep-09.wav"></audio>

<script src="https://ad.gigapub.tech/script?id=1511"></script>
<script>
let currentGame = "shoot"; // "shoot" or "catch"
let timerDuration = 10;
let timer = timerDuration;
let timerInterval;
let ctx = document.getElementById("gameCanvas").getContext("2d");
let beep = document.getElementById("beepSound");
let gameOver = document.getElementById("gameOverSound");

// Draw game based on currentGame
function drawGame() {
    ctx.clearRect(0, 0, 800, 500);
    if (currentGame === "shoot") {
        ctx.fillStyle = "white";
        ctx.font = "30px Arial";
        ctx.fillText("ðŸŽ¯ Game Tembak Target", 250, 250);
    } else {
        ctx.fillStyle = "yellow";
        ctx.font = "30px Arial";
        ctx.fillText("ðŸ’° Game Tangkap Koin", 250, 250);
    }
}

// Update timer circle
function updateTimerDisplay() {
    let percent = timer / timerDuration;
    let circle = document.getElementById("timerCircle");
    let offset = 283 - (283 * percent);
    circle.setAttribute("stroke-dashoffset", offset);
    
    if (percent > 0.5) circle.setAttribute("stroke", "green");
    else if (percent > 0.2) circle.setAttribute("stroke", "orange");
    else circle.setAttribute("stroke", "red");

    let timerText = document.getElementById("timerText");
    timerText.textContent = timer;
    if (timer <= 3) {
        timerText.classList.add("pulse");
        beep.play();
    } else {
        timerText.classList.remove("pulse");
    }
}

// Start the timer
function startTimer() {
    timer = timerDuration;
    updateTimerDisplay();
    timerInterval = setInterval(() => {
        timer--;
        updateTimerDisplay();
        if (timer <= 0) {
            clearInterval(timerInterval);
            gameOver.play();
            showAd();
        }
    }, 1000);
}

// Show Giga ad then switch game
function showAd() {
    window.showGiga()
    .then(() => {
        currentGame = (currentGame === "shoot") ? "catch" : "shoot";
        startGame();
    })
    .catch(e => {
        currentGame = (currentGame === "shoot") ? "catch" : "shoot";
        startGame();
    });
}

// Start game
function startGame() {
    drawGame();
    startTimer();
}

// Init
startGame();
</script>
</body>
</html>
