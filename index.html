<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game Miner + Iklan Giga.pub</title>
<style>
    body, html {
        margin: 0;
        padding: 0;
        overflow: hidden;
        background: #222;
        color: #fff;
        font-family: Arial, sans-serif;
    }
    canvas {
        display: block;
        background: url('https://i.ibb.co/3zSxj4X/mine-bg.jpg') center/cover no-repeat;
    }
    #hud {
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(0,0,0,0.5);
        padding: 10px;
        border-radius: 10px;
    }
    #btnRestart {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        padding: 15px 25px;
        font-size: 20px;
        background: gold;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        display: none;
    }
</style>
</head>
<body>

<div id="hud">
    ⛏ Koin: <span id="score">0</span> | ⏳ Waktu: <span id="time">30</span>d
</div>
<button id="btnRestart">Main Lagi</button>

<canvas id="gameCanvas"></canvas>

<!-- Script iklan Giga.pub -->
<script src="https://ad.gigapub.tech/script?id=1511"></script>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let score = 0;
let timeLeft = 30;
let isPlaying = true;
let player = { x: canvas.width/2, y: canvas.height/2, r: 20 };

function drawPlayer() {
    ctx.beginPath();
    ctx.arc(player.x, player.y, player.r, 0, Math.PI*2);
    ctx.fillStyle = "gold";
    ctx.fill();
    ctx.closePath();
}

function drawCoin(x, y) {
    ctx.beginPath();
    ctx.arc(x, y, 10, 0, Math.PI*2);
    ctx.fillStyle = "yellow";
    ctx.fill();
    ctx.closePath();
}

let coins = [];
function spawnCoin() {
    let x = Math.random() * canvas.width;
    let y = Math.random() * canvas.height;
    coins.push({x, y});
}

function update() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawPlayer();
    coins.forEach((c, i) => {
        drawCoin(c.x, c.y);
        let dx = c.x - player.x;
        let dy = c.y - player.y;
        let dist = Math.sqrt(dx*dx + dy*dy);
        if(dist < player.r + 10) {
            coins.splice(i, 1);
            score++;
            document.getElementById('score').textContent = score;
            if(score % 50 === 0) showAd(); // Iklan bonus tiap 50 koin
        }
    });
}

function gameLoop() {
    if(isPlaying) {
        update();
        requestAnimationFrame(gameLoop);
    }
}

canvas.addEventListener('click', e => {
    player.x = e.clientX;
    player.y = e.clientY;
});

function timerTick() {
    if(timeLeft > 0 && isPlaying) {
        timeLeft--;
        document.getElementById('time').textContent = timeLeft;
        setTimeout(timerTick, 1000);
    } else {
        endGame();
    }
}

function endGame() {
    isPlaying = false;
    showAd(() => {
        document.getElementById('btnRestart').style.display = 'block';
    });
}

function restartGame() {
    score = 0;
    timeLeft = 30;
    coins = [];
    document.getElementById('score').textContent = score;
    document.getElementById('time').textContent = timeLeft;
    document.getElementById('btnRestart').style.display = 'none';
    isPlaying = true;
    spawnCoin();
    timerTick();
    gameLoop();
}

// Fungsi tampilkan iklan Giga.pub
function showAd(callback) {
    if(window.showGiga) {
        window.showGiga()
        .then(() => { if(callback) callback(); })
        .catch(() => { if(callback) callback(); });
    } else {
        if(callback) callback();
    }
}

setInterval(spawnCoin, 1000);
restartGame();

document.getElementById('btnRestart').addEventListener('click', () => {
    showAd(() => restartGame());
});
</script>

</body>
</html>
